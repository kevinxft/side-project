# LifeStock 项目需求与实现总结

本文档汇总了当前阶段已实现的所有核心需求、架构设计及其技术细节。

## 1. 核心架构：灵活数据模型
为了适应多样化的生活物品管理，架构从“宽表存储”进化为“任务驱动型”模型。

*   **Items (物品表)**:
    *   **通用化**: 仅保留 ID、名称、图标、备注等基础字段。
    *   **Metadata (元数据)**: 使用 JSON 格式存储类型特定字段（如库存数量、账号余额、手机号等），无需修改数据库即可扩展新类型。
    *   **分类支持**: 目前预设了产品 (Product)、账号 (Account)、号码 (Phone)、耗材 (Supply) 和其他 (Other)。
*   **Reminders (提醒表)**:
    *   **独立性**: 提醒与物品分离，一个物品可对应多个提醒。
    *   **双模式**: 支持“一次性到期”和“周期性复发”（天/周/月/年）。
    *   **自动算薪**: 周期性任务标记完成后，系统基于 `interval` 和 `unit` 自动计算并更新 `nextDueDate`。
*   **Reminder Logs (操作日志)**:
    *   完整记录每次任务的完成时间，供后续统计分析。

## 2. 交互体验：现代 iOS 审美
界面遵循 "Liquid Glass" (iOS 26) 风格，注重通透感与动效。

*   **首页 (Home)**:
    *   **动态展示**: 根据物品 `type` 自动解析 metadata，智能展示关键信息（如“库存：5件”、“余额：¥100”）。
    *   **高效编辑**: 首页左上角铅笔图标进入编辑模式，支持：
        *   **单个/多选**: 勾选框选择。
        *   **全选/取消全选**: 右上角一键操作，提升批量处理效率。
        *   **批量删除**: 级联删除关联的提醒与日志。
*   **日历页 (Calendar)**:
    *   **动态红点**: 红色小圆点实时标记有任务的日期。
    *   **任务面板**: 点击日期查看当日所有到期/待办事项，支持一键“标记完成”。
*   **添加/编辑弹窗 (AddItemModal)**:
    *   **稳定布局**: 固定 90% 屏幕高度，解决切换类型时布局闪烁/抖动问题。
    *   **集成设置**: 录入物品时可同步开启并配置提醒规则。

## 3. 开发与调试工具
为了方便开发迭代与功能测试，内置了一系列辅助功能：

*   **✨ 魔法棒 (Seed Data)**:
    *   首页左上角快捷入口。
    *   **动态时间戳**: 自动生成“已逾期 (昨天)”、“今日到期”、“明天到期”及“常态周期”等多种测试场景的数据。
    *   **环境重置**: 每次点击会自动清空旧数据，保持调试环境干净。
*   **初始化保障**:
    *   **Schema 自动同步**: 应用启动时通过 Drizzle 自动执行 Migration。
    *   **数据库版本隔离**: 当前使用 `lifestock_v3.db`，确保在重置架构后不产生数据冲突。

## 4. 后续规划 (Roadmap)
- [x] **详情页**: 支持查看单个物品的详细历史记录和图表统计。
- [x] **全局搜索**: 快速定位成百上千个生活物品。
- [ ] **自动备份**: 数据库云端同步或通过系统文件导出。
- [ ] **分类管理**: 自定义物品分类及其专属图标。

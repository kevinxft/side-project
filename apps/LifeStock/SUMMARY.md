# LifeStock 项目概览与开发总结

本文档汇总了 LifeStock 项目的核心架构、功能需求及最新开发进展。

---

## 🏗 核心架构：灵活数据模型

为了适应多样化的生活物品管理，架构采用了“任务驱动型”模型：

*   **Items (物品表)**:
    *   **通用化**: 仅保留 ID、名称、图标、备注等基础字段。
    *   **Metadata (元数据)**: 使用 JSON 格式存储类型特定字段（如库存数量、账号余额、手机号等），实现零成本类型扩展。
    *   **预设分类**: 产品 (Product)、账号 (Account)、号码 (Phone)、耗材 (Supply) 和其他 (Other)。
*   **Reminders (提醒表)**:
    *   **独立性**: 提醒与物品分离，支持一对多关系。
    *   **双模式**: 支持“一次性到期”和“周期性复发”（天/周/月/年）。
    *   **逻辑自驱动**: 任务完成后，系统自动计算下一次 `nextDueDate`。
*   **Reminder Logs (操作日志)**:
    *   记录每次任务的完成时间，供后续统计分析。

---

## 🌟 核心功能实现

### 1. 首页 (Home)
- **动态展示**: 智能解析 metadata展示关键信息。
- **iOS 26 审美**: 采用 `rounded-3xl` 圆角、毛玻璃效果和柔和阴影。
- **管理模式**: 支持单选/多选、一键全选及级联批量删除。

### 2. 全局搜索 (Search)
- **实时过滤**: 毫秒级检索名称、备注及元数据。
- **类型分组**: 结果按物品类型分类，结构清晰。

### 3. 物品详情 (Detail)
- **全量数据**: 展示物品所有属性及关联提醒。
- **习惯图表**: SVG 实现的最近 7 天完成趋势图。
- **历史时间线**: 追溯物品的每一次状态变更。

### 4. 日历视图 (Calendar)
- **状态标记**: 红点标记任务日期。
- **待办面板**: 快速“标记完成”当日事项。

---

## ✅ 最近迭代总结 (2026-01-20)

本次迭代大幅提升了应用的 **原生感** 与 **交互稳定性**：

*   **UI 深度重构**: 全面适配 Inset Grouped 布局，优化了卡片文字粗细（改为 Semibold）及图标背景。
*   **设置页上线**: 极简设计，提供通知总开关及版本号查询。
*   **交互黑科技**: 
    - 重构 Add 按钮为 **状态驱动触发**，配合 `navigation.setOptions` 彻底解决点击无响应问题。
    - 增加 `BottomSheetBackdrop` 遮罩层。
*   **性能加固**: 优化了数据流同步逻辑，修复了 Service 层 TypeScript 错误。

---

## 🛠 开发与调试
*   **Seed Data (魔法棒)**: 一键生成多场景测试数据（逾期/待办/周期）。
*   **Schema 同步**: Drizzle 自动处理数据库 Migration。
*   **隔离环境**: 目前使用 `lifestock_v3.db`。

---

## 📂 修改的文件
- `app/(tabs)/(home)/index.tsx`, `[id].tsx`
- `app/(tabs)/(search)/index.tsx`
- `app/(tabs)/(settings)/index.tsx`
- `components/AddItemModal.tsx`
- `db/services.ts`
